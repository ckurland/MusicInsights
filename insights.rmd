---
title: "Music Insights"
author: "Connor Kurland"
output: html_notebook
---

First, we need tidyverse to handle data importing and wrangling...

```{R}
#suppressMessages(install.packages("tidyverse"))
suppressMessages(library(tidyverse))

#avoid absolute paths
#use relative paths (can use URLs)
survey <- read_csv("https://raw.githubusercontent.com/introdsci/MusicSurvey/master/music-survey.csv")

preferences <- read_csv("https://raw.githubusercontent.com/introdsci/MusicSurvey/master/preferences-survey.csv")

```

Number of rows
```{R}
nrow(survey)
```

Column names
```{R}
colnames(survey)
```

Levels
```{R}
levels(survey)
```
Number of rows
```{R}
nrow(preferences)
```

Column names
```{R}
colnames(preferences)
```

Levels
```{R}
levels(preferences)
```

Cleaning data frame column names:
```{R}
colnames(survey)[colnames(survey)=="First, we are going to create a pseudonym for you to keep this survey anonymous (more or less). Which pseudonym generator would you prefer?"] <-"generator_name"
colnames(survey)[colnames(survey)=="What is your pseudonym"] <- "pseudonym"
```


new Functions to use:
strsplit()
parse_datetime()

Here we are going to change all column names to something workable and consistent for the dataset survey:
```{R}
colnames(survey)[colnames(survey)=="Timestamp"] <- "time_submitted"

colnames(survey)[colnames(survey)=="generator_name"] <- "pseudonym_generator"

colnames(survey)[colnames(survey)=="What is your pseudonym?"] <- "pseudonym"

colnames(survey)[colnames(survey)=="Sex"] <- "sex"

colnames(survey)[colnames(survey)=="Major"] <- "academic_major"

colnames(survey)[colnames(survey)=="Academic Year"] <- "academic_level"

colnames(survey)[colnames(survey)=="Year you were born (YYYY)"] <- "year_born"

colnames(survey)[colnames(survey)=="Which musical instruments/talents do you play? (Select all that apply)"] <- "instrument_list"

colnames(survey)[colnames(survey)=="Artist"] <- "favorite_song_artist"

colnames(survey)[colnames(survey)=="Song"] <- "favorite_song"

colnames(survey)[colnames(survey)=="Link to song (on Youtube or Vimeo)"] <- "favorite_song_link"
```


Loading two more libraries:
```{R}
library(dplyr)
library(tidyr)
```

in dplyr and tidyr cheat sheet dplyr::data_frame is deprecated, use tibbles

Creating the Person table:
```{R}
person <- tibble(time_submitted=survey$time_submitted,pseudonym_generator=survey$pseudonym_generator,pseudonym=survey$pseudonym,sex=survey$sex,academic_major=survey$academic_major,academic_level=survey$academic_level,year_born=survey$year_born,favorite_song=survey$favorite_song)
```

Create the Favorite Song table:
```{R}
favorite_song <- tibble(pseudonym=survey$pseudonym,favorite_song=survey$favorite_song,favorite_song_artist=survey$favorite_song_artist,favorite_song_link=survey$favorite_song_link)
```

A dataset is tidy if:
1) 1 column per variable
2) 1 row per observation
3) cohesive table

```{R}
library(readr)
```

```{R}
person$time_submitted <- as.POSIXlt(parse_datetime(person$time_submitted,format="%m/%d/%y %H:%M"))
```

